name: AWS IAM Get Session Token
id: 9c4773f4-779a-11eb-8488-acde48001122
version: 1
date: '2021-02-25'
author: Rod Soto
type: batch
datamodel:
- Endpoint
- Authentication
description: UPDATE_DESCRIPTION
search: 'sourcetype=aws:cloudtrail eventSource=sts.amazonaws.com eventName=GetSessionToken | spath "responseElements.credentials.accessKeyId" | search "responseElements.credentials.accessKeyId"=* "userIdentity.arn"=* | stats count min(_time) as firstTime max(_time) as lastTime by awsRegion eventName eventType responseElements.credentials.accessKeyId userIdentity.arn sourceIPAddress | `aws_iam_get_session_token_filter`'
how_to_implement: UPDATE_HOW_TO_IMPLEMENT
known_false_positives: UPDATE_KNOWN_FALSE_POSITIVES
references:
tags:
  analytic_story:
  - UPDATE_STORY_NAME
  dataset:
  - UPDATE_DATASET_URL
  kill_chain_phases:
  - Lateral Movement
  mitre_attack_id:
  - T1078
  product:
  - Splunk Enterprise
  - Splunk Enterprise Security
  - Splunk Cloud
  