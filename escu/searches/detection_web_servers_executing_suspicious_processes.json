{
  "asset_type": "Web Server",
  "channel": "ESCU",
  "confidence": "medium",
  "correlation_rule": {
    "notable": {
      "nes_fields": "dest, user, process",
      "rule_description": "This search looks for suspicious processes on all systems labeled as web servers",
      "rule_title": "Web Servers Executing Suspicious Processes"
    },
    "risk": {
      "risk_object": "dest",
      "risk_object_type": [
        "system"
      ],
      "risk_score": 75
    },
    "suppress": {
      "suppress_fields": "dest,process",
      "suppress_period": "28800s"
    }
  },
  "creation_date": "2017-03-14",
  "data_metadata": {
    "data_models": [
      "Application_State"
    ],
    "data_source": [
      "Endpoint Intel"
    ],
    "providing_technologies": [
      "Carbon Black Response",
      "CrowdStrike Falcon",
      "Sysmon",
      "Tanium",
      "Ziften"
    ]
  },
  "eli5": "This detection search uses the Enterprise Security Application State data model. The search uses tstats to search within an accelerated data model to find suspicious applications or processes such as whoami, ping, iptables, wget, service, or curl, running on hosts which are marked as web servers in the Assets and Identity Framework of ES.",
  "how_to_implement": "To successfully implement this detection search, Splunk needs to ingest data around process activity, such as that generated by endpoint security tools such as Carbon Black or endpoint data sources such as Sysmon, and populate the Application_State data model. In addition, web servers will need to be identified in the Assets and Identity Framework of Enterprise Security.",
  "known_false_positives": "Some of these processes may be used legitimately on web servers during maintenance or other administrative tasks.",
  "maintainers": [
    {
      "company": "Splunk",
      "email": "davidd@splunk.com",
      "name": "David Dorsey"
    }
  ],
  "mappings": {
    "cis20": [
      "CIS 3"
    ],
    "kill_chain_phases": [
      "Actions on Objectives"
    ],
    "mitre_attack": [
      "Defense Evasion",
      "Exploitation of Vulnerability",
      "Execution",
      "Discovery",
      "System Information Discovery"
    ],
    "nist": [
      "PR.IP"
    ]
  },
  "modification_date": "2017-09-11",
  "original_authors": [
    {
      "company": "Splunk",
      "email": "davidd@splunk.com",
      "name": "David Dorsey"
    }
  ],
  "scheduling": {
    "cron_schedule": "0 * * * *",
    "earliest_time": "-70m@m",
    "latest_time": "-10m@m"
  },
  "search": "| tstats `summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Application_State where All_Application_State.dest_category=\"web_server\" AND (All_Application_State.process=\"*whoami*\" OR All_Application_State.process=\"*ping*\" OR All_Application_State.process=\"*iptables*\" OR All_Application_State.process=\"*wget*\" OR All_Application_State.process=\"*service*\" OR All_Application_State.process=\"*curl*\") by All_Application_State.process, All_Application_State.dest | `ctime(firstTime)` | `ctime(lastTime)` | `drop_dm_object_name(\"All_Application_State\")`",
  "search_description": "This search looks for suspicious processes on all systems labeled as web servers.",
  "search_id": "ec3b7601-689a-4463-94e0-c9f45638efb9",
  "search_name": "Web Servers Executing Suspicious Processes",
  "search_type": "detection",
  "security_domain": "endpoint",
  "spec_version": 1,
  "version": "1.0"
}
