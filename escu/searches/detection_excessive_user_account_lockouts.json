{
  "asset_type": "Windows",
  "channel": "ESCU",
  "confidence": "medium",
  "correlation_rule": {
    "notable": {
      "nes_fields": "user",
      "rule_description": "The account $user$ has been locked out an excessive number of times",
      "rule_title": "$user$ locked account an excessive number of times"
    },
    "risk": {
      "risk_object": "user",
      "risk_object_type": [
        "system"
      ],
      "risk_score": 40
    },
    "suppress": {
      "suppress_fields": "user",
      "suppress_period": "86400s"
    }
  },
  "creation_date": "2017-08-17",
  "data_metadata": {
    "data_source": [
      "Windows Event Logs"
    ],
    "data_sourcetypes": [
      "WinEventLog:Security"
    ],
    "providing_technologies": [
      "Microsoft Windows"
    ]
  },
  "eli5": "This search looks for the Windows event code 4740 within your Windows Security Logs, which indicates that an account locked out. It then counts the numbers of times an account has been locked out in a four hour window and displays those accounts with a count greater than five.",
  "how_to_implement": "While this search does not require you to adhere to Splunk CIM, you must be ingesting your Windows security event logs in order for this search to execute successfully.",
  "known_false_positives": "It is possible that a legitimate user is experiencing an issue causing multiple account login failures leading to lockouts.",
  "maintainers": [
    {
      "company": "Splunk",
      "email": "davidd@splunk.com",
      "name": "David Dorsey"
    }
  ],
  "mappings": {
    "cis20": [
      "CIS 16"
    ],
    "mitre_attack": [
      "Valid Accounts"
    ],
    "nist": [
      "PR.IP"
    ]
  },
  "modification_date": "2017-09-23",
  "original_authors": [
    {
      "company": "Splunk",
      "email": "davidd@splunk.com",
      "name": "David Dorsey"
    }
  ],
  "scheduling": {
    "cron_schedule": "0 * * * *",
    "earliest_time": "-4h@h",
    "latest_time": "-10m@m"
  },
  "search": "sourcetype=WinEventLog:Security EventCode=4740 | stats count min(_time) as firstTime max(_time) as lastTime by user, signature | `ctime(firstTime)` | `ctime(lastTime)` | search count > 5",
  "search_description": "This search detects accounts that have been locked out a relatively high number of times in a short period.",
  "search_id": "95a7f9a5-6096-437e-a19e-86f42ac609bd",
  "search_name": "Detect Excessive User Account Lockouts",
  "search_type": "detection",
  "security_domain": "access",
  "spec_version": 1,
  "status": "production",
  "team_notes": "",
  "version": "1.0"
}
